atom.declare('atom.Router',{history:[],initialize:function(settings){window.addEventListener('hashchange',this.route.bind(this));this.events=atom.Events(this);this.settings=atom.Settings(this.settings).set(settings).addEvents(this.events);},get current(){return this.history.last;},route:function(){var uri=atom.uri();this.history.push(uri.anchor);this.events.fire(uri.anchor);},navigate:function(name){if(this.current==name){return false;}
var base=window.location.href.split('#')[0];window.location.href=base+'#'+name;},back:function(){this.history.pop()
this.navigate(this.current);}});atom.declare('atom.View',{initialize:function(settings){this.events=atom.Events(this);this.settings=atom.Settings(settings).addEvents(this.events);var el=this.settings.get('el'),extend=this.settings.get('extend');this.el=el&&atom.dom(el);this._bindEvents();if(typeof extend==='object'){atom.core.extend(this,extend);}},create:function(){this.el=atom.dom.create.apply(this,arguments);this._bindEvents();return this;},render:function(){return this;},destroy:function(){if(this.el){this.el.destroy();}
return this;},_bindEvents:function(){if(!this.el){return false;}
var view=this,el=this.el,events=this.events.events;Object.map(events,function(callbacks,name,obj){el.bind(name,function(){view.events.fire(name,arguments);});});},_unbindEvents:function(){}});atom.declare('atom.Model',{defaults:{},initialize:function(settings){this.events=atom.Events(this);this.settings=atom.Settings(this.defaults).set(settings).addEvents(this.events);},get:function(name){return this.settings.get(name);},set:function(name,value){this.settings.values[name]=value;},has:function(name){return this.get(name)!==null;},get json(){return atom.clone(this.settings.values);}});
